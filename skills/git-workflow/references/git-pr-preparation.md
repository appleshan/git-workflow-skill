# Git PR å‡†å¤‡æŒ‡å—

æœ¬æ–‡æ¡£æä¾›å®Œæ•´çš„ Pull Request å‡†å¤‡æµç¨‹ï¼ŒåŒ…æ‹¬ä»£ç å®¡æŸ¥æ£€æŸ¥æ¸…å•ã€è´¨é‡ä¿è¯æ­¥éª¤å’Œæœ€ä½³å®è·µã€‚

---

## PR å‡†å¤‡å®Œæ•´æµç¨‹

```
1. è‡ªæ£€ä»£ç è´¨é‡
   â†“
2. ç¡®ä¿ä¸ base åˆ†æ”¯åŒæ­¥
   â†“
3. æŸ¥çœ‹å˜æ›´æ‘˜è¦
   â†“
4. è¿è¡Œæµ‹è¯•å’Œ lint
   â†“
5. æ•´ç† commit å†å²
   â†“
6. æ¨é€åˆ°è¿œç¨‹
   â†“
7. åˆ›å»º PR
   â†“
8. å¡«å†™ PR æè¿°
   â†“
9. è¯·æ±‚å®¡æŸ¥
```

---

## 1. ä»£ç å®¡æŸ¥æ£€æŸ¥æ¸…å•

### 1.1 æŸ¥çœ‹åˆ†æ”¯å˜æ›´

**æŸ¥çœ‹ commit åˆ—è¡¨**ï¼š
```bash
git blg
# æˆ–æŒ‡å®šæ•°é‡
git blg 20  # æŸ¥çœ‹æœ€è¿‘ 20 ä¸ª commits
```

**æœŸæœ›**ï¼š
- âœ… Commit æ¶ˆæ¯æ¸…æ™°ã€ç¬¦åˆè§„èŒƒ
- âœ… æ¯ä¸ª commit æ˜¯åŸå­æ€§çš„ï¼ˆå®Œæˆä¸€ä¸ªå°ç›®æ ‡ï¼‰
- âœ… æ²¡æœ‰"WIP"ã€"fix typo"ç­‰åƒåœ¾ commit

**ä¸ç¬¦åˆæœŸæœ›ï¼Ÿ**
```bash
# æ•´ç† commit å†å²
git ri  # git branch-rebase (äº¤äº’å¼ rebase)
```

---

**æŸ¥çœ‹å®Œæ•´å·®å¼‚**ï¼š
```bash
git bdf | less
```

**æœŸæœ›**ï¼š
- âœ… åªåŒ…å«ç›¸å…³ä¿®æ”¹ï¼Œæ²¡æœ‰æ„å¤–å˜æ›´
- âœ… æ²¡æœ‰è°ƒè¯•ä»£ç ï¼ˆconsole.logã€print ç­‰ï¼‰
- âœ… æ²¡æœ‰ä¸´æ—¶æ–‡ä»¶æˆ–é…ç½®æ–‡ä»¶
- âœ… ä»£ç æ ¼å¼ç»Ÿä¸€

**å‘ç°é—®é¢˜ï¼Ÿ**
```bash
# ä¿®æ”¹ä¸Šæ¬¡ commit
git cma  # æ·»åŠ æ‰€æœ‰ä¿®æ”¹åˆ°ä¸Šæ¬¡ commit

# æˆ–ä¿®æ”¹æŒ‡å®š commit
git fixup
```

---

**æŸ¥çœ‹æ–‡ä»¶ä¿®æ”¹ç»Ÿè®¡**ï¼š
```bash
git bdf --stat
```

**æœŸæœ›**ï¼š
- âœ… ä¿®æ”¹èŒƒå›´åˆç†ï¼ˆä¸æ˜¯åŠ¨äº†å‡ ç™¾ä¸ªæ–‡ä»¶ï¼‰
- âœ… æµ‹è¯•æ–‡ä»¶å’Œå®ç°æ–‡ä»¶éƒ½æœ‰ä¿®æ”¹
- âœ… æ–°åŠŸèƒ½æœ‰å¯¹åº”çš„æµ‹è¯•è¦†ç›–

---

### 1.2 ä»£ç è´¨é‡æ£€æŸ¥

**æ£€æŸ¥é¡¹**ï¼š

#### åŠŸèƒ½å®Œæ•´æ€§
- â–¡ å®ç°äº†éœ€æ±‚ä¸­çš„æ‰€æœ‰åŠŸèƒ½ç‚¹
- â–¡ è¾¹ç•Œæƒ…å†µå¤„ç†å®Œå–„
- â–¡ é”™è¯¯å¤„ç†åˆç†

#### ä»£ç è§„èŒƒ
- â–¡ å‘½åæ¸…æ™°ï¼ˆå˜é‡ã€å‡½æ•°ã€ç±»ï¼‰
- â–¡ å‡½æ•°å•ä¸€èŒè´£
- â–¡ ä»£ç å¤æ‚åº¦åˆç†ï¼ˆåµŒå¥—å±‚çº§ â‰¤ 3ï¼‰
- â–¡ æ²¡æœ‰é‡å¤ä»£ç 

#### æ€§èƒ½è€ƒè™‘
- â–¡ æ²¡æœ‰æ˜æ˜¾çš„æ€§èƒ½ç“¶é¢ˆ
- â–¡ æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–ï¼ˆç´¢å¼•ã€N+1 é—®é¢˜ï¼‰
- â–¡ å¤§æ•°æ®é‡å¤„ç†åˆç†

#### å®‰å…¨æ£€æŸ¥
- â–¡ æ²¡æœ‰ SQL æ³¨å…¥é£é™©ï¼ˆä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ï¼‰
- â–¡ æ²¡æœ‰ XSS é£é™©ï¼ˆè¾“å‡ºè½¬ä¹‰ï¼‰
- â–¡ æ•æ„Ÿä¿¡æ¯ä¸åœ¨ä»£ç ä¸­ï¼ˆå¯†ç ã€API keyï¼‰
- â–¡ æƒé™æ£€æŸ¥åˆ°ä½

---

## 2. ä¸ Base åˆ†æ”¯åŒæ­¥

### 2.1 æ£€æŸ¥åŒæ­¥çŠ¶æ€

```bash
# åˆ‡æ¢åˆ° base åˆ†æ”¯
git zz  # git checkout $(git base-branch)

# æ‹‰å–æœ€æ–°ä»£ç 
git pl  # git pull

# æŸ¥çœ‹ base åˆ†æ”¯çŠ¶æ€
git log -1 --oneline

# åˆ‡å› topic åˆ†æ”¯
git z -  # åˆ‡å›ä¸Šä¸€ä¸ªåˆ†æ”¯
```

---

### 2.2 åˆ¤æ–­æ˜¯å¦éœ€è¦åŒæ­¥

**æŸ¥çœ‹ base æ˜¯å¦æœ‰æ–° commits**ï¼š
```bash
git log $(git base-branch)..HEAD --oneline  # ä½ çš„ commits
git log HEAD..$(git base-branch) --oneline  # base çš„æ–° commits
```

**å¦‚æœ base æœ‰æ–° commits**ï¼š

**æ–¹æ¡ˆ 1ï¼šMergeï¼ˆæ¨èï¼Œç®€å•å®‰å…¨ï¼‰**
```bash
git merge $(git base-branch)
# è§£å†³å†²çªï¼ˆå¦‚æœæœ‰ï¼‰
git mgc  # git merge --continue
```

**æ–¹æ¡ˆ 2ï¼šRebaseï¼ˆä¿æŒçº¿æ€§å†å²ï¼‰**
```bash
git snapshot "before-rebase"  # å¤‡ä»½
git rebase $(git base-branch)
# è§£å†³å†²çªï¼ˆå¦‚æœæœ‰ï¼‰
git rc  # git rebase --continue
```

**é€‰æ‹©å»ºè®®**ï¼š
- å›¢é˜Ÿåå¥½çº¿æ€§å†å² â†’ Rebase
- é‡è¦åŠŸèƒ½åˆ†æ”¯ã€å¤šäººåä½œ â†’ Merge
- ä¸ç¡®å®šæ—¶ â†’ Mergeï¼ˆæ›´å®‰å…¨ï¼‰

---

## 3. è´¨é‡ä¿è¯æ£€æŸ¥æ¸…å•

### 3.1 æµ‹è¯•è¦†ç›–

**è¿è¡Œæµ‹è¯•**ï¼š
```bash
# å•å…ƒæµ‹è¯•
npm test  # æˆ– pytest, go test, etc.

# é›†æˆæµ‹è¯•
npm run test:integration

# E2E æµ‹è¯•
npm run test:e2e
```

**æ£€æŸ¥é¡¹**ï¼š
- â–¡ æ‰€æœ‰æµ‹è¯•é€šè¿‡
- â–¡ æ–°åŠŸèƒ½æœ‰å¯¹åº”çš„æµ‹è¯•
- â–¡ æµ‹è¯•è¦†ç›–ç‡è¾¾æ ‡ï¼ˆé€šå¸¸ â‰¥ 70%ï¼‰
- â–¡ è¾¹ç•Œæƒ…å†µæœ‰æµ‹è¯•è¦†ç›–

**å¦‚æœæµ‹è¯•å¤±è´¥**ï¼š
```bash
# ä¿®å¤å amend åˆ°ä¸Šæ¬¡ commit
git add <fixed-files>
git cmu  # git commit --amend --no-edit (åªåŒ…å«å·²è¿½è¸ªæ–‡ä»¶)
```

---

### 3.2 Lint æ£€æŸ¥

**è¿è¡Œ Lint**ï¼š
```bash
npm run lint  # æˆ– flake8, golangci-lint, etc.
```

**æ£€æŸ¥é¡¹**ï¼š
- â–¡ æ²¡æœ‰ lint é”™è¯¯
- â–¡ ä»£ç é£æ ¼ç»Ÿä¸€
- â–¡ æ²¡æœ‰æœªä½¿ç”¨çš„å˜é‡/import

**è‡ªåŠ¨ä¿®å¤**ï¼š
```bash
npm run lint:fix  # æˆ– black, gofmt, etc.
git add -A
git cmu
```

---

### 3.3 ç±»å‹æ£€æŸ¥ï¼ˆå¦‚é€‚ç”¨ï¼‰

**TypeScript**ï¼š
```bash
npm run type-check  # æˆ– tsc --noEmit
```

**Python**ï¼š
```bash
mypy src/
```

**æ£€æŸ¥é¡¹**ï¼š
- â–¡ æ²¡æœ‰ç±»å‹é”™è¯¯
- â–¡ å…³é”®å‡½æ•°æœ‰ç±»å‹æ³¨è§£

---

### 3.4 æ„å»ºéªŒè¯

**è¿è¡Œæ„å»º**ï¼š
```bash
npm run build  # æˆ– make build, go build, etc.
```

**æ£€æŸ¥é¡¹**ï¼š
- â–¡ æ„å»ºæˆåŠŸ
- â–¡ æ²¡æœ‰è­¦å‘Šï¼ˆæˆ–è­¦å‘Šå·²çŸ¥ä¸”å¯æ¥å—ï¼‰
- â–¡ äº§ç‰©å¤§å°åˆç†

---

## 4. Commit å†å²æ•´ç†

### 4.1 æ£€æŸ¥ Commit è´¨é‡

**æŸ¥çœ‹ commit åˆ—è¡¨**ï¼š
```bash
git blg
```

**å¥½çš„ commit ç‰¹å¾**ï¼š
- âœ… æ¶ˆæ¯æ¸…æ™°ï¼š`feat: add user authentication`
- âœ… åŸå­æ€§ï¼šä¸€ä¸ª commit å®Œæˆä¸€ä¸ªå°åŠŸèƒ½
- âœ… å¯å›æ»šï¼šæ¯ä¸ª commit éƒ½èƒ½ç‹¬ç«‹è¿è¡Œ
- âœ… æµ‹è¯•é€šè¿‡ï¼šæ¯ä¸ª commit éƒ½é€šè¿‡ CI

**åçš„ commit ç‰¹å¾**ï¼š
- âŒ `WIP`ã€`temp`ã€`fix`ï¼ˆæ— æ„ä¹‰æ¶ˆæ¯ï¼‰
- âŒ æ··åˆå¤šä¸ªåŠŸèƒ½
- âŒ `fix previous commit`ï¼ˆåº”è¯¥ squashï¼‰
- âŒ è¶…å¤§ commitï¼ˆå‡ åƒè¡Œä¿®æ”¹ï¼‰

---

### 4.2 æ•´ç† Commit å†å²

**äº¤äº’å¼ Rebase**ï¼š
```bash
git ri  # git branch-rebase (rebase åˆ°ä¸ base çš„åˆ†å‰ç‚¹)
```

**å¸¸ç”¨æ“ä½œ**ï¼š
- `pick`ï¼šä¿ç•™ commit
- `squash` (s)ï¼šåˆå¹¶åˆ°ä¸Šä¸€ä¸ª commit
- `fixup` (f)ï¼šåˆå¹¶åˆ°ä¸Šä¸€ä¸ª commitï¼ˆä¸¢å¼ƒæ¶ˆæ¯ï¼‰
- `reword` (r)ï¼šä¿®æ”¹ commit æ¶ˆæ¯
- `drop` (d)ï¼šåˆ é™¤ commit

**ç¤ºä¾‹**ï¼š
```bash
# åŸå§‹å†å²
pick abc123 feat: add login
pick def456 fix typo
pick ghi789 add tests

# æ•´ç†å
pick abc123 feat: add login with tests
fixup def456 fix typo  # åˆå¹¶åˆ°ä¸Šé¢
fixup ghi789 add tests  # åˆå¹¶åˆ°ä¸Šé¢
```

**ç»“æœ**ï¼šä¸€ä¸ªå¹²å‡€çš„ commitï¼š`feat: add login with tests`

---

### 4.3 ä¿®å¤å•ä¸ª Commit

**ä¿®æ”¹æœ€è¿‘çš„ commit**ï¼š
```bash
git cma   # æ·»åŠ æ‰€æœ‰ä¿®æ”¹åˆ°ä¸Šæ¬¡ commit
git cmae  # æ·»åŠ æ‰€æœ‰ä¿®æ”¹å¹¶ä¿®æ”¹æ¶ˆæ¯
```

**ä¿®æ”¹å†å²ä¸­çš„ commit**ï¼š
```bash
git fixup
# fzf é€‰æ‹©è¦ä¿®æ”¹çš„ commit
# æš‚å­˜ä¿®æ”¹åä¼šè‡ªåŠ¨ rebase
```

---

## 5. æ¨é€å’Œ PR åˆ›å»º

### 5.1 ç¡®è®¤æ¨é€çŠ¶æ€

**æ£€æŸ¥æœªæ¨é€çš„ commits**ï¼š
```bash
git ahead
```

**æ¨é€åˆ°è¿œç¨‹**ï¼š
```bash
git ps  # git push
```

**å¦‚æœæ¨é€å¤±è´¥ï¼ˆè¿œç¨‹æœ‰æ–° commitsï¼‰**ï¼š
```bash
git pl  # git pull (merge æˆ– rebaseï¼Œå–å†³äºé…ç½®)
git ps
```

---

### 5.2 åˆ›å»º PR

**ä½¿ç”¨ gh CLIï¼ˆæ¨èï¼‰**ï¼š
```bash
gh pr create
```

**æŒ‰æç¤ºè¾“å…¥**ï¼š
1. é€‰æ‹© base åˆ†æ”¯ï¼ˆé€šå¸¸æ˜¯ mainï¼‰
2. è¾“å…¥ PR æ ‡é¢˜
3. è¾“å…¥ PR æè¿°ï¼ˆæˆ–è·³è¿‡ï¼Œç¨åå¡«å†™ï¼‰

**æ‰‹åŠ¨åœ¨ GitHub/GitLab åˆ›å»º**ï¼š
1. è®¿é—®ä»“åº“é¡µé¢
2. ç‚¹å‡»"New Pull Request"
3. é€‰æ‹© base å’Œ head åˆ†æ”¯
4. å¡«å†™æ ‡é¢˜å’Œæè¿°

---

## 6. PR æè¿°æœ€ä½³å®è·µ

### 6.1 PR æ ‡é¢˜è§„èŒƒ

**æ ¼å¼**ï¼š
```
<type>: <short description>
```

**ç±»å‹ï¼ˆtypeï¼‰**ï¼š
- `feat`: æ–°åŠŸèƒ½
- `fix`: Bug ä¿®å¤
- `refactor`: é‡æ„
- `docs`: æ–‡æ¡£æ›´æ–°
- `test`: æµ‹è¯•ç›¸å…³
- `chore`: æ„å»º/å·¥å…·ç›¸å…³

**ç¤ºä¾‹**ï¼š
```
feat: add user authentication with OAuth 2.0
fix: resolve race condition in cache invalidation
refactor: extract common validation logic
```

---

### 6.2 PR æè¿°æ¨¡æ¿

```markdown
## Summary
<!-- ç”¨ 1-3 å¥è¯æ¦‚è¿°è¿™ä¸ª PR åšäº†ä»€ä¹ˆ -->

è§£å†³çš„é—®é¢˜ï¼š[#123] ç”¨æˆ·æ— æ³•ç™»å½•
å®ç°çš„åŠŸèƒ½ï¼šæ·»åŠ äº† OAuth 2.0 è®¤è¯ï¼Œæ”¯æŒ Google å’Œ GitHub ç™»å½•

## Changes
<!-- è¯¦ç»†è¯´æ˜åšäº†å“ªäº›ä¿®æ”¹ -->

- æ·»åŠ  `AuthService` å¤„ç† OAuth æµç¨‹
- å®ç° `GoogleAuthProvider` å’Œ `GitHubAuthProvider`
- æ›´æ–°å‰ç«¯ç™»å½•é¡µé¢ï¼Œæ·»åŠ ç¬¬ä¸‰æ–¹ç™»å½•æŒ‰é’®
- æ·»åŠ å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•ï¼ˆè¦†ç›–ç‡ 85%ï¼‰

## Technical Details (å¯é€‰)
<!-- æ¶æ„å†³ç­–ã€æŠ€æœ¯é€‰å‹ã€æƒè¡¡è€ƒè™‘ -->

- é€‰æ‹© Passport.js ä½œä¸ºè®¤è¯æ¡†æ¶ï¼ˆç¤¾åŒºæ´»è·ƒã€æ’ä»¶ä¸°å¯Œï¼‰
- ä½¿ç”¨ JWT å­˜å‚¨ç”¨æˆ·ä¼šè¯ï¼ˆæ— çŠ¶æ€ã€æ˜“æ‰©å±•ï¼‰
- æ•æ„Ÿé…ç½®é€šè¿‡ç¯å¢ƒå˜é‡æ³¨å…¥ï¼ˆä¸æäº¤åˆ°ä»£ç åº“ï¼‰

## Testing
<!-- å¦‚ä½•æµ‹è¯•è¿™ä¸ª PR -->

- [ ] æœ¬åœ°è¿è¡Œå•å…ƒæµ‹è¯•ï¼š`npm test`
- [ ] æœ¬åœ°è¿è¡Œé›†æˆæµ‹è¯•ï¼š`npm run test:integration`
- [ ] æ‰‹åŠ¨æµ‹è¯• Google ç™»å½•æµç¨‹
- [ ] æ‰‹åŠ¨æµ‹è¯• GitHub ç™»å½•æµç¨‹
- [ ] éªŒè¯é”™è¯¯å¤„ç†ï¼ˆç½‘ç»œå¤±è´¥ã€ç”¨æˆ·æ‹’ç»æˆæƒï¼‰

## Screenshots (å¯é€‰)
<!-- å¦‚æœæ˜¯ UI æ”¹åŠ¨ï¼Œé™„ä¸Šæˆªå›¾ -->

Before:
[æˆªå›¾]

After:
[æˆªå›¾]

## Breaking Changes (å¯é€‰)
<!-- æ˜¯å¦æœ‰ä¸å…¼å®¹çš„ä¿®æ”¹ -->

æ— ç ´åæ€§ä¿®æ”¹ã€‚ç°æœ‰çš„ç”¨æˆ·å/å¯†ç ç™»å½•æ–¹å¼ä¿æŒä¸å˜ã€‚

## Related Issues
<!-- å…³è”çš„ Issues æˆ– PRs -->

Closes #123
Related to #456
```

---

### 6.3 è‡ªåŠ¨ç”Ÿæˆ PR æè¿°

**ä½¿ç”¨ Git å†å²ç”Ÿæˆæ‘˜è¦**ï¼š
```bash
# è·å– commit åˆ—è¡¨
git blg

# è·å–å·®å¼‚ç»Ÿè®¡
git bdf --stat

# åˆå¹¶ç”Ÿæˆåˆç¨¿
cat <<EOF
## Summary
$(git log --oneline $(git base-branch)..HEAD | head -1)

## Changes
$(git log --oneline $(git base-branch)..HEAD | sed 's/^/- /')

## Files Changed
$(git bdf --stat | tail -1)
EOF
```

---

## 7. PR å®¡æŸ¥å‡†å¤‡

### 7.1 è‡ªå®¡æ¸…å•

**åœ¨è¯·æ±‚å®¡æŸ¥å‰ï¼Œè‡ªå·±å…ˆå®¡æŸ¥ä¸€é**ï¼š

#### ä»£ç å±‚é¢
- â–¡ æ‰€æœ‰å˜æ›´éƒ½æ˜¯å¿…éœ€çš„ï¼ˆæ²¡æœ‰æ„å¤–ä¿®æ”¹ï¼‰
- â–¡ ä»£ç é€»è¾‘æ¸…æ™°æ˜“æ‡‚
- â–¡ å…³é”®é€»è¾‘æœ‰æ³¨é‡Š
- â–¡ æ²¡æœ‰ TODO æˆ– FIXMEï¼ˆé™¤éæœ‰ issue è¿½è¸ªï¼‰

#### æµ‹è¯•å±‚é¢
- â–¡ CI å…¨éƒ¨é€šè¿‡ï¼ˆæµ‹è¯•ã€lintã€æ„å»ºï¼‰
- â–¡ æœ¬åœ°æ‰‹åŠ¨æµ‹è¯•è¿‡å…³é”®æµç¨‹
- â–¡ è¾¹ç•Œæƒ…å†µæµ‹è¯•è¦†ç›–

#### æ–‡æ¡£å±‚é¢
- â–¡ README æ›´æ–°ï¼ˆå¦‚æœæœ‰æ–°åŠŸèƒ½ï¼‰
- â–¡ API æ–‡æ¡£æ›´æ–°ï¼ˆå¦‚æœæœ‰æ¥å£å˜æ›´ï¼‰
- â–¡ CHANGELOG æ›´æ–°ï¼ˆå¦‚æœé¡¹ç›®è¦æ±‚ï¼‰

---

### 7.2 è¯·æ±‚å®¡æŸ¥

**é€‰æ‹©åˆé€‚çš„å®¡æŸ¥è€…**ï¼š
- ä»£ç æ‰€æœ‰è€…ï¼ˆCODEOWNERS æ–‡ä»¶ï¼‰
- ç›¸å…³æ¨¡å—çš„ä¸»è¦è´¡çŒ®è€…
- æŠ€æœ¯è´Ÿè´£äººæˆ–æ¶æ„å¸ˆ

**åœ¨ PR ä¸­ @mention**ï¼š
```markdown
@username è¯·å¸®å¿™å®¡æŸ¥è¿™ä¸ª PRï¼Œé‡ç‚¹å…³æ³¨ AuthService çš„å®ç°ã€‚
```

**æ·»åŠ æ ‡ç­¾**ï¼š
- `ready for review`ï¼šå‡†å¤‡å¥½å®¡æŸ¥
- `work in progress`ï¼šè¿˜åœ¨å¼€å‘ä¸­
- `needs discussion`ï¼šéœ€è¦è®¨è®º

---

## 8. å¿«é€Ÿ PR å‡†å¤‡å‘½ä»¤

### ä¸€é”®æ£€æŸ¥æ¸…å•

**åˆ›å»ºå¿«æ·è„šæœ¬** `~/.local/bin/git-pr-check`ï¼š
```bash
#!/bin/bash
# PR å‡†å¤‡å¿«é€Ÿæ£€æŸ¥

echo "=== PR å‡†å¤‡æ£€æŸ¥ ==="
echo

echo "1. æŸ¥çœ‹ commits:"
git blg

echo
echo "2. æŸ¥çœ‹æ–‡ä»¶å˜æ›´:"
git bdf --stat

echo
echo "3. ä¸ base åˆ†æ”¯å¯¹æ¯”:"
base=$(git base-branch)
ahead=$(git rev-list --count origin/$base..HEAD 2>/dev/null || echo "0")
behind=$(git rev-list --count HEAD..origin/$base 2>/dev/null || echo "0")
echo "   é¢†å…ˆ origin/$base: $ahead commits"
echo "   è½å origin/$base: $behind commits"

echo
echo "4. è¿è¡Œæµ‹è¯•:"
if command -v npm &> /dev/null; then
    npm test
elif command -v pytest &> /dev/null; then
    pytest
elif command -v go &> /dev/null; then
    go test ./...
else
    echo "   æœªæ£€æµ‹åˆ°æµ‹è¯•æ¡†æ¶ï¼Œè¯·æ‰‹åŠ¨è¿è¡Œæµ‹è¯•"
fi

echo
echo "5. è¿è¡Œ lint:"
if command -v npm &> /dev/null && grep -q '"lint"' package.json; then
    npm run lint
else
    echo "   æœªæ£€æµ‹åˆ° lint é…ç½®ï¼Œè¯·æ‰‹åŠ¨æ£€æŸ¥"
fi

echo
echo "=== æ£€æŸ¥å®Œæˆ ==="
echo "å‡†å¤‡å¥½åˆ›å»º PR äº†å—ï¼Ÿè¿è¡Œ: gh pr create"
```

**ä½¿ç”¨**ï¼š
```bash
chmod +x ~/.local/bin/git-pr-check
git-pr-check
```

---

### PR æ¨¡æ¿è‡ªåŠ¨åŒ–

**åˆ›å»º PR æ¨¡æ¿** `.github/pull_request_template.md`ï¼š
```markdown
## Summary
<!-- ç®€è¦æè¿°è¿™ä¸ª PR -->

## Type of Change
- [ ] ğŸ¨ Feature (new functionality)
- [ ] ğŸ› Bug fix
- [ ] ğŸ“ Documentation
- [ ] â™»ï¸ Refactor
- [ ] âœ… Tests
- [ ] ğŸ”§ Configuration

## Checklist
- [ ] ä»£ç è‡ªå®¡å®Œæˆ
- [ ] æµ‹è¯•é€šè¿‡ï¼ˆ`npm test` æˆ–ç­‰æ•ˆå‘½ä»¤ï¼‰
- [ ] Lint é€šè¿‡ï¼ˆ`npm run lint` æˆ–ç­‰æ•ˆå‘½ä»¤ï¼‰
- [ ] æ–‡æ¡£å·²æ›´æ–°ï¼ˆå¦‚éœ€è¦ï¼‰
- [ ] Breaking changes å·²æ ‡æ³¨ï¼ˆå¦‚æœ‰ï¼‰

## Test Plan
<!-- å¦‚ä½•æµ‹è¯•è¿™ä¸ª PR -->
```

---

## 9. å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### é—®é¢˜ 1ï¼šPR å¤ªå¤§ï¼Œå®¡æŸ¥è€…çœ‹ä¸è¿‡æ¥

**åŸå› **ï¼šä¸€æ¬¡æ€§æ”¹äº†å¤ªå¤šä¸œè¥¿

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ–¹æ¡ˆ 1ï¼šæ‹†åˆ†æˆå¤šä¸ª PR
git tnr feature/user-auth-part1
# åªæäº¤æ ¸å¿ƒåŠŸèƒ½
git tmg

git tnr feature/user-auth-part2
# æäº¤é…å¥—çš„æµ‹è¯•å’Œæ–‡æ¡£

# æ–¹æ¡ˆ 2ï¼šåœ¨ PR æè¿°ä¸­æä¾›å®¡æŸ¥æŒ‡å—
## Review Guide
1. å…ˆçœ‹ `src/auth/core.ts`ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼Œ100 è¡Œï¼‰
2. å†çœ‹ `src/auth/providers/`ï¼ˆå…·ä½“å®ç°ï¼Œ200 è¡Œï¼‰
3. æœ€åçœ‹æµ‹è¯•æ–‡ä»¶ï¼ˆ300 è¡Œï¼‰
```

---

### é—®é¢˜ 2ï¼šCI å¤±è´¥ï¼Œä½†æœ¬åœ°æµ‹è¯•é€šè¿‡

**å¸¸è§åŸå› **ï¼š
- ç¯å¢ƒå·®å¼‚ï¼ˆNode ç‰ˆæœ¬ã€æ“ä½œç³»ç»Ÿï¼‰
- ä¾èµ–ç‰ˆæœ¬ä¸ä¸€è‡´
- ç¯å¢ƒå˜é‡ç¼ºå¤±

**æ’æŸ¥æ­¥éª¤**ï¼š
```bash
# 1. æŸ¥çœ‹ CI æ—¥å¿—ï¼Œæ‰¾åˆ°å¤±è´¥çš„æµ‹è¯•
gh pr checks  # æˆ–åœ¨ PR é¡µé¢æŸ¥çœ‹

# 2. åœ¨æœ¬åœ°æ¨¡æ‹Ÿ CI ç¯å¢ƒ
docker run -it node:18 bash  # ä½¿ç”¨ CI ç›¸åŒçš„é•œåƒ
npm ci  # ä½¿ç”¨ package-lock.json ç²¾ç¡®å®‰è£…ä¾èµ–
npm test

# 3. ä¿®å¤åæ¨é€
git add <fixed-files>
git cmu
git ps
```

---

### é—®é¢˜ 3ï¼šMerge å†²çª

**è§£å†³æµç¨‹**ï¼š
```bash
# 1. åŒæ­¥ base åˆ†æ”¯
git fetch origin
git merge origin/$(git base-branch)

# 2. è§£å†³å†²çª
git edit-unmerged  # ç¼–è¾‘å†²çªæ–‡ä»¶

# 3. æ ‡è®°å·²è§£å†³
git add-unmerged

# 4. ç»§ç»­ merge
git mgc

# 5. æ¨é€
git ps
```

---

### é—®é¢˜ 4ï¼šå¿˜è®°æ·»åŠ æµ‹è¯•

**è¡¥æ•‘æªæ–½**ï¼š
```bash
# 1. æ·»åŠ æµ‹è¯•æ–‡ä»¶
vim tests/test_auth.py

# 2. è¿è¡Œæµ‹è¯•ç¡®è®¤é€šè¿‡
pytest tests/test_auth.py

# 3. Amend åˆ°æœ€åä¸€ä¸ª commitï¼ˆå¦‚æœ commit æ˜¯"add feature"ï¼‰
git add tests/test_auth.py
git cmu

# 4. æ¨é€
git ps --force-with-lease  # å®‰å…¨çš„ force push
```

---

## 10. PR å‡†å¤‡æœ€ä½³å®è·µæ€»ç»“

### é»„é‡‘æ³•åˆ™

1. **å°è€Œç¾**ï¼šPR å°½é‡å°ï¼ˆ< 400 è¡Œä¿®æ”¹ï¼‰ï¼Œæ˜“å®¡æŸ¥
2. **åŸå­æ€§**ï¼šä¸€ä¸ª PR åªåšä¸€ä»¶äº‹
3. **è‡ªå®¡å…ˆè¡Œ**ï¼šè¯·æ±‚å®¡æŸ¥å‰è‡ªå·±å…ˆå®¡æŸ¥ä¸€é
4. **æè¿°æ¸…æ™°**ï¼šè®©å®¡æŸ¥è€… 5 åˆ†é’Ÿå†…ç†è§£ä½ åšäº†ä»€ä¹ˆ
5. **æµ‹è¯•å®Œå–„**ï¼šæ–°åŠŸèƒ½å¿…é¡»æœ‰æµ‹è¯•ï¼Œè¦†ç›–ç‡ â‰¥ 70%
6. **CI å¿…è¿‡**ï¼šä¸è¦æäº¤ä¼šè®© CI å¤±è´¥çš„ä»£ç 

---

### æ—¶é—´è§„åˆ’

```
æ€»æ—¶é—´ï¼š30-60 åˆ†é’Ÿï¼ˆå–å†³äº PR å¤§å°ï¼‰

ä»£ç è‡ªå®¡ï¼š10 åˆ†é’Ÿ
â”œâ”€ æŸ¥çœ‹ commits å’Œå·®å¼‚
â””â”€ æ£€æŸ¥ä»£ç è´¨é‡

è´¨é‡ä¿è¯ï¼š15-30 åˆ†é’Ÿ
â”œâ”€ è¿è¡Œæµ‹è¯•ï¼ˆ5-15 åˆ†é’Ÿï¼‰
â”œâ”€ è¿è¡Œ lintï¼ˆ2-5 åˆ†é’Ÿï¼‰
â””â”€ æ‰‹åŠ¨æµ‹è¯•ï¼ˆ5-10 åˆ†é’Ÿï¼‰

åŒæ­¥å’Œæ•´ç†ï¼š5-10 åˆ†é’Ÿ
â”œâ”€ ä¸ base åŒæ­¥ï¼ˆ2-5 åˆ†é’Ÿï¼‰
â””â”€ æ•´ç† commit å†å²ï¼ˆ3-5 åˆ†é’Ÿï¼‰

åˆ›å»º PRï¼š5-10 åˆ†é’Ÿ
â”œâ”€ æ¨é€ä»£ç ï¼ˆ1-2 åˆ†é’Ÿï¼‰
â””â”€ å¡«å†™ PR æè¿°ï¼ˆ4-8 åˆ†é’Ÿï¼‰
```

---

## å‚è€ƒèµ„æ–™

- Git Aliases é…ç½®ï¼š[aliases.gitconfig](https://github.com/appleshan/dotfiles/blob/stow/git/.config/git/conf/aliases.gitconfig)
- Git Workflow Skillï¼š`~/.claude/skills/git-workflow/SKILL.md`
- GitHub PR æœ€ä½³å®è·µï¼šhttps://github.com/blog/1943-how-to-write-the-perfect-pull-request
- Google Code Review Guidelinesï¼šhttps://google.github.io/eng-practices/review/
